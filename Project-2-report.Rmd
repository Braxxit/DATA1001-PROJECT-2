---
title: "Factors affecting Sleep"
author: "540214264, 540754276, 540062713, 540286434, 540301162, 540496066"
subtitle: "Project 2"
date: "University of Sydney | DATA1001 | APRIL 2024"

output:
  html_document:
    fig_caption: yes
    number_sections: yes
    self_contained: yes
    css: bootstrap.min.css
    toc: true
    toc_depth: 3
    toc_float: true
    code_folding: hide
    

---

<br>

# Executive Summary

-   The aim of this report is to ascertain the main factor causing sleep deprivation among young adults today.
-   Data collected shows a positive correlation between screen time and quality of sleep 

<br>



# Full Report

<br>

## Initial Data Analysis (IDA)



### Source

The data used in this report was collected from university students from 3/28/24 to 4/14/24 through the usage of Google Forms:
<br>
(https://forms.gle/xxXj6JNymotvkEot5)

```{r, warning=FALSE, message=FALSE}
# Shows barplot of ages of survey participants
library(tidyverse)
library(readr)
Responses = read_csv("./Project 2 responses - Sheet1.csv", show_col_types = FALSE)
Responses = filter(Responses, Age < 30)
ggplot(Responses) + 
  geom_histogram(aes(x = Age), bins=30, fill = "steelblue") +
  labs(y = "Count") +
  scale_x_continuous(breaks = 0:23) 

```

### Structure

We received 30 responses for our survey. Each row represents a survey response while each of the columns represent our variables. This survey contained both quantitative (Hours of sleep, Screen time, Phone before bed) and qualitative (Exercise, Time of medication) variables. 

### Limitations

Not everyone has a fixed sleeping schedule. It is quite likely that our survey participants had fluctuating hours of sleep throughout their weeks. This could be due to their differing school timetables, causing them to sleep and wake up at varying times.Also, the sleep quality is biased on how people judge their own sleep quality, because we are aware that everyone has their own perspective about what a good sleep quality is.

### Assumptions
We assume that all survey participants will tell the truth and will take the survey seriously. Any illogical responses (i.e. age of participant being 999 years old) will not be included in our results.

### Data Clearing
For data clearing, we will use a function called `filter()` to remove any illogical results that may damage the reliability of our results.


<br>
<br>
<h2> Research theme </h2>
We will investigate the relationship between the sleeping behavior of University students and the activities they partake in during their normal day.

<br>

## Research Question 1

How does phone usage before bed affects one's sleep quality and hours?

```{r message = FALSE, warning = F}
library(tidyverse)
ggplot(Responses, aes(x = `Quality of sleep`)) + 
  geom_bar(aes(fill= `Phone before bed`)) +
  ggtitle("Quality of Sleep ") +
  labs(x = "Quality of Sleep", y = "Frequency", fill = "Phone usage before bed") +
  scale_y_continuous(breaks = 0:15) +
  guides(fill = guide_legend(reverse = T))
```


Summary: As we can see above, Although it doesn't apply to all cases, people who use their phones before bed tend to have lower sleep quality. We assume those who still have good sleep quality despite using phone before bed are special case ( they may exercise regularly, thus making them having better sleep quality )

## Research Question 2

How does screen time influence duration of sleep?

```{r, warning=FALSE, message=FALSE}
sleep_time_levels <- c("20:00:00", "20:30:00", "21:00:00", "21:30:00", 
                       "22:00:00","22:30:00","23:00:00","23:30:00",
                       "00:00:00","00:30:00","01:00:00", "01:30:00",
                       "02:00:00", "10:00:00", "11:00:00")


ggplot(Responses) +
  geom_bar(aes(factor(`Sleep time`, sleep_time_levels), fill = `Phone before bed`)) +
  scale_y_continuous(breaks = 1:10) +
  ggtitle("Usage of phone VS Sleeping times") +
  ylab("Frequency") +
  xlab("Sleeping Times") +
  coord_flip()

```

The bar chart above allows us to draw a conclusion that usage of phones before bed leads to a much later sleeping time. Thus, by assuming that people who sleep late get lesser hours of sleep, we can make the claim that the usage of phones before bed also leads to a shorter duration of sleep. 

```{r, message = F, warning = F}
Responses$`Hours of sleep` <- as.numeric(Responses$`Hours of sleep`)
Responses$`Screen time` <- as.numeric(Responses$`Screen time`)
ggplot(Responses, aes(x=`Screen time`, y=`Hours of sleep`)) +
  geom_point() + 
  geom_smooth(method = 'lm', se = T) +
  scale_x_continuous(breaks = 0:16) + 
  labs(x = "Screen Time (Hours)", y = "Sleeping Duration (Hours)", title = "Scatter plot of Sleeping Duration against Screen Time")
```

```{r}
cor(Responses$`Screen time`, Responses$`Hours of sleep`)
```
Correlation Coefficient = 0.0214867
<br>
From this linear regression graph, we can conclude that sleeping duration is not influenced by screen time since the correlation coefficient shown above is near 0 and positive. There are 2 reasons as to why we cannot use this as an anti-hypothesis to our first claim. Firstly, the area of the standard error above is incredibly significant. Hence, it could also be said that the projected values shown above are far from accurate as well. Secondly, a high amount of screen time does not necessarily mean that the user uses their phones right before bed.

```{r}
l_m = lm(`Hours of sleep` ~ `Screen time`, Responses)
ggplot(l_m, aes(x=.fitted, y=.resid)) +
  geom_point() +
  ylab("Residual") +
  xlab("Fitted") +
  geom_hline(yintercept = 0, color="blue")
```
From the residual plot above, we can see that the residual plot appears to be random and supports the idea that the linear fit is appropriate for the data.

Summary:<br>
As per our first claim, we hypothesized that duration of sleep is reduced due to the usage of phones before bed

# References

Style: APA

<br>

# Acknowledgment
24/2/2024 Online |Braxton, William, Vincent, Alex, Mingye|- Figuring out what we want to explore and formulating research question
2/3/2024 Online |Braxton, William, Vincent, Alex, Mingye|- Started to list out variables and formulating questions
3/3/2024 Online |Braxton, William, Vincent, Alex, Mingye| - Finished off Project 1 and created a survey in Google forms
10/03/2024 Online on discord |Braxton, William, Vincent, Alex, Damara, Mingye| - Designing the plan and research topic for Project plan
14/03/2024 After Lab |Braxton, William, Vincent, Alex, Damara, Mingye| - Creating the survey questions and the google form
28/03/2024 After Lab |Braxton, William, Mingye, Damara| - Posting the survey to obtain results
15/04/2024 Online on Github |Braxton| - Creating github repo and initial scaffolding for report
17/04/2024 Online on Github |Damara| - Added research questions
18/04/2024 After Lab Online |Braxton, William, Vincent, Alex, Mingye, Damara| - Communicating report data 
18/04/2024 Online on Github and Discord | Braxton, William, Vincent, Damara, Mingye| - Writing out report 
